Tech giants lead rally as stocks near records Amazon surges